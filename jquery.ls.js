(function(c){var q=function(n,f){var g=c(n);f||(f={});c.each(c.fn.polyglotLanguageSwitcher.defaults,function(c){var h=g.data(c);h&&(f[c]=h)});return f};c.fn.polyglotLanguageSwitcher=function(n){var f=function(a,b){return c.isFunction(a[b])?a[b].call(a):a[b]},g=function(a,b){var d=b._model.invoker,e=c(d);switch(a.type){case "opening":b._model.status="opening";e.trigger(c.Event("popupOpening",{target:a.target,invoker:d}));break;case "opened":b._model.status="opened";var f=c(a.target);b._model.documentClickHandler||
(b._model.documentClickHandler=c(document).on("click",function(a){0===c(a.target).closest(f).length&&k(f,b)}));b._model.documentKeyHandler||(b._model.documentKeyHandler=c(document).on("keydown",function(a){27===a.keyCode&&k(f,b)}));e.trigger(c.Event("popupOpened",{target:a.target,invoker:d}));break;case "closing":b._model.status="closing";e.trigger(c.Event("popupClosing",{target:a.target,invoker:d}));break;case "closed":b._model.status="closed",b._model.documentClickHandler&&(c(document).off("click",
b._model.documentClickHandler),b._model.documentClickHandler=null),b._model.documentKeyHandler&&(c(document).off("keydown",b._model.documentKeyHandler),b._model.documentKeyHandler=null),e.trigger(c.Event("popupClosed",{target:a.target,invoker:d}))}},p=function(a){var b=a._model.invoker,d=a.animEffect,e=f(a,"gridColumns"),g=f(a,"selectedLang");a=c('<div class="pls-language-container-scrollable"><table class="pls-language-container"><tbody><tr></tr></tbody></table></div>').hide();"slide"===d&&a.slideUp(0);
var h=a.find("tr"),d=c(b).find("li"),k=Math.round(d.length/e),m,l=[];d.each(function(a){var b=c(this),d=b.children("a"),e=d.data("langId");g===e&&(m=d.addClass("pls-selected-locale").clone().attr("href","#"));l.push(b);0===(a+1)%k&&(h.append(c("<td></td>").append(c("<ul></ul>").append(l))),l=[])});0<l.length&&(h.append(c("<td></td>").append(c("<ul></ul>").append(l))),l=[]);m||(m=d.first().children("a").addClass("pls-selected-locale").clone().attr("href","#"));c(b).empty().append(m).append(a)},h=function(a,
b){var c=b.animEffect,e=b.animSpeed;"closed"===b._model.status&&(g({type:"opening",target:a.get()},b),"fade"===c?a.fadeIn(e,function(){g({type:"opened",target:a.get()},b)}):"slide"===c&&a.slideDown(e,function(){g({type:"opened",target:a.get()},b)}))},k=function(a,b){var c=f(b,"animEffect"),e=f(b,"animSpeed");"opened"===b._model.status&&(g({type:"closing",target:a.get()},b),"fade"===c?a.fadeOut(e,function(){g({type:"closed",target:a.get()},b)}):"slide"===c&&a.slideUp(e,function(){g({type:"closed",
target:a.get()},b)}))},r=function(a){var b=a._model.invoker,d=c(b).children(".pls-language-container-scrollable"),e=f(a,"openMode");if("click"===e)c(b).children("a").on("click",function(){h(d,a);return!1});else if("hover"===e){var g=f(a,"hoverTimeout");c(b).children("a").hover(function(){clearTimeout(a._model.closePopupTimeout);a._model.closePopupTimeout=-1;h(d,a)},function(){0>a._model.closePopupTimeout&&(a._model.closePopupTimeout=setTimeout(function(){k(d,a)},g))});d.hover(function(){clearTimeout(a._model.closePopupTimeout);
a._model.closePopupTimeout=-1},function(){0>a._model.closePopupTimeout&&(a._model.closePopupTimeout=setTimeout(function(){k(d,a)},g))})}else throw"Open mode '"+e+"' not supported";};return this.each(function(){var a=c.extend({_model:{invoker:this,status:"closed",closePopupTimeout:-1,documentClickHandler:null,documentKeyHandler:null}},c.fn.polyglotLanguageSwitcher.defaults,q(this,n));p(a);r(a)})};c.fn.polyglotLanguageSwitcher.defaults={openMode:"hover",hoverTimeout:200,animSpeed:200,animEffect:"fade",
gridColumns:1,selectedLang:function(){return c("html").attr("lang")}}})(jQuery);
